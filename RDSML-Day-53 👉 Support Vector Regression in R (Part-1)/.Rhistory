var1= 500
print('var1')
print(var1)
var_2= mobile
var_2= 'mobile'
print(var_2)
assign('var5', 400)
print(var5)
if_=30
if2= 'mobile phone'
print(class(if_))
print(class(if2))
print(ls())
#find variables
print(ls(all.names = TRUE))
rm(var5)
print(ls(all.names = TRUE))
var5=300
print(ls(all.names = TRUE))
6*8
library(readxl)
data_MoST_24_25 <- read_excel("Desktop/Article/R/All works/data MoST 24-25.xlsx",
sheet = "Sheet4", range = "A1:AA87")
View(data_MoST_24_25)
library(readxl)
pc <- read_excel("Desktop/Article/R/All works/data MoST 24-25.xlsx",
sheet = "Sheet4", range = "A1:AA87")
View(pc)
library(devtools)
install.packages('devtools')
library(devtools)
library(devtools)
library(ggbiplot)
library(devtools)
library(ggbiplot)
library(ggplot2)
pca = prcomp(pc[-1],
center = TRUE,
scale. = TRUE)
pca$scale
print(pca)
summary(pca)
g = ggbiplot(pca,
obs.scale = 1,
var.scale = 1,
groups = pc$water,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.68)
View(g)
g = ggbiplot(pca,
obs.scale = 1,
var.scale = 1,
groups = pc$water,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.68)
g = ggbiplot(pca,
obs.scale = 1,
var.scale = 1,
groups = pc$water,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.68)+
scale_color_discrete(name = '') +
theme(legend.direction = 'horizontal',
legend.position = 'top')
print(g)
g = ggbiplot(pca,
obs.scale = 1,
var.scale = 1,
groups = pc$water,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.68)+
scale_color_discrete(name = '') +
theme(legend.direction = 'horizontal',
legend.position = 'right')
g = ggbiplot(pca,
obs.scale = 1,
var.scale = 1,
groups = pc$water,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.68)+
scale_color_discrete(name = '') +
theme(legend.direction = 'horizontal',
legend.position = 'right')
print(g)
g = ggbiplot(pca,
obs.scale = 1,
var.scale = 1,
groups = pc$water,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.68)+
scale_color_discrete(name = '') +
theme(legend.direction = 'vertical',
legend.position = 'top')
print(g)
rnorm(3, mean = 0.92, sd = 0.05)
rnorm(3, mean = 1.24, sd = 0.03)
rnorm(3, mean = 75.93, sd = 0.34)
rnorm(3, mean = 1.66, sd = 0.02)
rnorm(3, mean = 1.45, sd = 0.07)
rnorm(3, mean = 1.26, sd = 0.04)
rnorm(3, mean = 81.65, sd = 0.12)
rnorm(3, mean = 1.41, sd = 0.04)
rnorm(3, mean = 3.47, sd = 0.24)
rnorm(3, mean = 1.15, sd = 0.003)
rnorm(3, mean = 85.10, sd = 0.21)
rnorm(3, mean = 1.13, sd = 0.009)
setwd("~/Desktop/Article/R/All works/R-for-Data-Science-and-Machine-Learning-Batch8-NBICT/RDSML-Day-53 ðŸ‘‰ Support Vector Regression in R (Part-1)")
# Setup: packages and data loading
install.packages(c("e1071","ggplot2","dplyr"))
library(e1071)
library(ggplot2)
library(dplyr)
library(e1071)
library(ggplot2)
library(dplyr)
# Loading the dataset
dataset <- read.csv("day.csv")
bike <- dataset %>%
select(cnt, temp, atemp, hum, windspeed, season, yr, mnth,
holiday, weekday, workingday, weathersit)
str(bike)
bike <- bike %>%
mutate(
season = factor(season),
yr = factor(yr),
mnth = factor(mnth),
holiday = factor(holiday),
weekday = factor(weekday),
workingday = factor(workingday),
weathersit = factor(weathersit)
)
str(bike)
# Train/Test Split
set.seed(123)
n <- nrow(bike)
indices <- seq_len(n)
train_idx <- sample(indices, size = 0.7 * n)
train_set <- bike[train_idx, ]
test_set <- bike[-train_idx, ]
num_cols = c("temp", "atemp", "hum", "windspeed")
train_means = sapply(train_set[, num_cols], mean)
train_sds = sapply(train_set[, num_cols], sd)
scale_num = function(df){
df[, num_cols] = sweep(df[, num_cols], 2, train_means, FUN = "-")
df[, num_cols] = sweep(df[, num_cols], 2, train_sds, FUN = "/")
return(df)
}
train_scaled = scale_num(train_set)
test_scaled = scale_num(test_set)
lm_model = lm(cnt ~ ., data = train_scaled)
summary(lm_model)
lm_pred = predict(lm_model, newdata = test_scaled)
rmse = function(actual, pred) sqrt(mean((actual-pred)^2))
lm_rmse = rmse(test_scaled$cnt, lm_pred)
lm_rmse
mae = function(actual, pred) mean(abs(actual - pred))
lm_mae = mae(test_scaled$cnt, lm_pred)
lm_mae
svr_model = svm(cnt ~ ., data = train_scaled, type = "eps-regression", kernel = "linear")
summary(svr_model)
svr_pred = predict(svr_model, newdata = test_scaled)
svr_rmse = rmse(test_scaled$cnt, svr_pred)
svr_rmse
svr_mae = mae(test_scaled$cnt, svr_pred)
svr_mae
comparison = data.frame(
Model = c("Linear Regression", "Support Vector Regression"),
RMSE = c(lm_rmse, svr_rmse),
MAE = c(lm_mae, svr_mae)
)
print(comparison)
#Visualizing predictions
results = data.frame(
Actual = test_scaled$cnt,
Linear_Regression = lm_pred,
SVR = svr_pred
)
results_long = results %>%
tidyr::gather(key = "Model", value = "Predicted", -Actual)
ggplot(results_long, aes(x = Actual, y = Predicted, color = Model)) +
ggplot(results_long, aes(x = Actual, y = Predicted, color = Model)) +
geom_point(alpha = 0.5) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
labs(title = "Actual vs Predicted Counts",
x = "Actual Counts",
y = "Predicted Counts") +
theme_minimal()
results = data.frame(
Actual = test_scaled$cnt,
Linear_Regression = lm_pred,
SVR = svr_pred
)
results_long = results %>%
tidyr::gather(key = "Model", value = "Predicted", -Actual)
ggplot(results_long, aes(x = Actual, y = Predicted, color = Model)) +
geom_point(alpha = 0.5) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
labs(title = "Actual vs Predicted Counts",
x = "Actual Counts",
y = "Predicted Counts") +
theme_minimal()
svr_model = svm(cnt ~ ., data = train_scaled, type = "eps-regression", kernel = "linear")
summary(svr_model)
# Predicting on test set
svr_pred = predict(svr_model, newdata = test_scaled)
svr_rmse = rmse(test_scaled$cnt, svr_pred)
svr_rmse
svr_mae = mae(test_scaled$cnt, svr_pred)
svr_mae
comparison = data.frame(
Model = c("Linear Regression", "Support Vector Regression"),
RMSE = c(lm_rmse, svr_rmse),
MAE = c(lm_mae, svr_mae)
)
print(comparison)
#Comparing Linear Regression and SVR performance
svr_rmse;svr_mae
lm_rmse;lm_mae
svr_rbf = svm(
cnt ~ .,
data = train_scaled,
kernel = "radial",
cost = 10,
gamma = 0.1,
epsilon = 0.1
)
summary(svr_rbf)
summary(svr_model)
# Predicting on test set
svr_rbf_pred = predict(svr_rbf, newdata = test_scaled)
#Evaluation metrics for RBF SVR
svr_rbf_rmse = rmse(test_scaled$cnt, svr_rbf_pred)
svr_rbf_rmse
svr_rbf_mae = mae(test_scaled$cnt, svr_rbf_pred)
svr_rbf_mae
#Comparing all three models
svr_rbf_rmse;svr_rbf_mae
svr_rmse;svr_mae
lm_rmse;lm_mae
svr_rbf_pred
results = data.frame(
Actual = test_scaled$cnt,
Linear_Regression = lm_pred,
SVR_Linear = svr_pred,
SVR_RBF = svr_rbf_pred
)
results_long = results %>%
tidyr::pivot_longer(
cols = -Actual,
names_to = "Model",
values_to = "Predicted"
)
ggplot(results_long, aes(x = Actual, y = Predicted, color = Model)) +
geom_point(alpha = 0.6) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "black") +
labs(title = "Model Predictions vs Actual Values",
x = "Actual Values",
y = "Predicted Values") +
theme_minimal()
